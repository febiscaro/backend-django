{% extends "base.html" %}

{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h5 m-0">Meu perfil</h1>
  </div>

  {% with request.user as u %}
  <div class="card shadow-sm">
    <div class="card-body">
      <dl class="row mb-0">
        <dt class="col-sm-3">Nome completo</dt>
        <dd class="col-sm-9">{% firstof u.get_full_name u.nome_completo u.cpf %}</dd>

        <dt class="col-sm-3">CPF</dt>
        <dd class="col-sm-9">{{ u.cpf }}</dd>

        <dt class="col-sm-3">E-mail</dt>
        <dd class="col-sm-9">{{ u.email }}</dd>

        <dt class="col-sm-3">Data de nascimento</dt>
        <dd class="col-sm-9">{{ u.data_nascimento|date:"d/m/Y"|default:"—" }}</dd>

        <dt class="col-sm-3">Setor</dt>
        <dd class="col-sm-9">{{ u.setor|default:"—" }}</dd>

        <dt class="col-sm-3">Cargo</dt>
        <dd class="col-sm-9">{{ u.cargo|default:"—" }}</dd>

        <dt class="col-sm-3">Perfil</dt>
        <dd class="col-sm-9">{{ u.get_perfil_display|default:u.perfil }}</dd>

        <dt class="col-sm-3">Ativo?</dt>
        <dd class="col-sm-9">
          {% if u.is_active %}
            <span class="badge bg-success">Ativo</span>
          {% else %}
            <span class="badge bg-secondary">Inativo</span>
          {% endif %}
        </dd>

        <dt class="col-sm-3">Membro desde</dt>
        <dd class="col-sm-9">{{ u.date_joined|date:"d/m/Y H:i" }}</dd>

        <dt class="col-sm-3">Último acesso</dt>
        <dd class="col-sm-9">{{ u.last_login|date:"d/m/Y H:i"|default:"—" }}</dd>
      </dl>
    </div>
  </div>
  {% endwith %}

  <div class="mt-3 d-flex gap-2">
    <a class="btn btn-outline-primary" href="{% url 'password_change' %}">Trocar senha</a>
    {% if request.user.is_superuser %}
      <a class="btn btn-outline-secondary"
        href="/admin/accounts/user/{{ request.user.pk }}/change/"
        target="_blank" rel="noopener">Abrir no Admin</a>
    {% endif %}

  </div>
</div>
{% endblock %}
